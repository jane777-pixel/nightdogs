---
layout: layouts/base.njk
author: "{{ author or 'default' }}"
---

{# Only include the syntax highlighter CSS on blog posts, included with the CSS
per-page bundle #}
<style>
	{% include "node_modules/prismjs/themes/prism-okaidia.css" %}
</style>
<style>
	{% include "css/prism-diff.css" %}
</style>

{# Auto-switch to post author's theme #}
<script eleventy:ignore>
document.addEventListener('DOMContentLoaded', function() {
	const postAuthor = '{{ author }}';
	const validAuthors = ['jane', 'orionlw', 'adesse', 'nic', 'amelia', 'abby', 'ewan'];

	if (postAuthor && validAuthors.includes(postAuthor)) {
		// Set author theme
		document.documentElement.setAttribute('data-author', postAuthor);
		document.body.setAttribute('data-author', postAuthor);

		// Update author selector dropdowns to match
		const authorSelectors = document.querySelectorAll('.author-sync');
		authorSelectors.forEach(function(sel) {
			sel.value = postAuthor;
		});

		// Save preference
		try {
			localStorage.setItem('author-theme', postAuthor);
		} catch(e) {
			console.warn('Could not save author preference:', e);
		}

		console.log('Auto-switched to', postAuthor, 'theme for blog post');
	}
});
</script>

<article class="h-entry">
	<h1 class="post-title p-name">{{ title }}</h1>
	<div class="post-meta">
		<time class="dt-published" datetime="{{ page.date | htmlDateString }}">{{
			page.date | readableDate
		}}</time>
		{%- if author -%}
		<span class="post-author" style="margin-left: 1em">
			by
			<a href="/about#{{ author | slugify }}" class="h-card p-author">{{
				author
			}}</a>
		</span>
		{%- endif -%}
	</div>

	{%- if tags and tags.length -%}
	{%- set uniqueTags = tags | unique -%}
	<div class="post-tags" style="margin: 0.5em 0;">
		<span>Tags:</span>
		{%- for tag in uniqueTags %}
			{% if tag == "posts" %}
				<a href="/blog/" class="post-tag">posts</a>{% if not loop.last %}, {% endif %}
			{% else %}
				<a href="/tags/{{ tag | slugify }}/" class="post-tag">{{ tag }}</a>{% if not loop.last %}, {% endif %}
			{% endif %}
		{%- endfor %}
	</div>
	{%- endif -%}

	<div class="e-content">
		{{ content | safe }}
	</div>

	{%- include "recommendations.njk" -%}

	{%- if collections.posts %}
	<ul class="links-nextprev">
		{%- set nextPost = collections.posts | getNextCollectionItem(page) %} {%- if
		nextPost %}
		<li class="links-nextprev-next">
			<strong>Next</strong>:
			<a href="{{ nextPost.url }}">{{ nextPost.data.title }}</a>
		</li>
		{% endif %} {%- set previousPost = collections.posts |
		getPreviousCollectionItem(page) %} {%- if previousPost %}
		<li class="links-nextprev-previous">
			<strong>Previous</strong>:
			<a href="{{ previousPost.url }}">{{ previousPost.data.title }}</a>
		</li>
		{% endif %}
	</ul>
	{%- endif %}
{% set webmentionsUrl = page.url %}
{% include "webmentions.njk" %}
</article>
