<!doctype html>
<html lang="{{ metadata.language }}"{% if author %} data-author="{{ author }}"{% endif %}>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>{{ title or metadata.title }}</title>
        <meta name="description" content="{{ description or metadata.description }}">
        <link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="{{ metadata.title }}">

        <!-- Inline theme script to prevent FOUC -->
        <script>{% include "js/theme.js" %}</script>

        <!-- Load local fonts as a separate stylesheet -->
        <link rel="stylesheet" href="/css/fonts.css">

		{#- Render the CSS bundle using inlined CSS (for the fastest site performance in production) #}
		{% css %}

{# --- 2. Root and author variables (before any CSS uses them) --- #}
	:root {
  	--font-family: "Bitcount Grid Single", "Segoe UI", "Roboto", "Helvetica Neue", Arial, "Liberation Sans", sans-serif;
   	--font-family-monospace: Consolas, Menlo, Monaco, Andale Mono WT, Andale Mono, Lucida Console, Lucida Sans Typewriter, DejaVu Sans Mono, Bitstream Vera Sans Mono, Liberation Mono, Nimbus Mono L, Courier New, Courier, monospace;
    --syntax-tab-size: 2;
  --pico-background-color: #ffd6e0;
  --pico-color: #8b0020;
  --pico-primary: #b8002e;
  --pico-muted-color: #6d0015;
  {%- for author, data in authors | dictsort %}
    /* Author: {{ author }} */
    --author-{{ author }}-background: {{ data.theme.light.background }};
    --author-{{ author }}-color: {{ data.theme.light.color }};
    --author-{{ author }}-primary: {{ data.theme.light.primary }};
    --author-{{ author }}-muted: {{ data.theme.light.muted }};
    --author-{{ author }}-font-body: {{ data.theme.fonts.body|default('inherit')|safe }};
    --author-{{ author }}-font-header: {{ data.theme.fonts.header|default('inherit')|safe }};
    {%- if data.theme.fonts.mono %}
    --author-{{ author }}-font-mono: {{ data.theme.fonts.mono|safe }};
    {%- endif %}
  {%- endfor %}
}
@media (prefers-color-scheme: dark) {
  :root {
    {%- for author, data in authors | dictsort %}
      /* Author: {{ author }} */
      --author-{{ author }}-background: {{ data.theme.dark.background }};
      --author-{{ author }}-color: {{ data.theme.dark.color }};
      --author-{{ author }}-primary: {{ data.theme.dark.primary }};
      --author-{{ author }}-muted: {{ data.theme.dark.muted }};
    {%- endfor %}
  }
}

{# --- 3. Pico and your main CSS (these will now use the variables above) --- #}
{% include "css/pico.min.css" %}
{% include "css/index.css" %}
{% endcss %}
<style>{% getBundle "css" %}</style>

		{#- Add the heading-anchors web component to the JavaScript bundle #}
		<script type="module">{% include "node_modules/@zachleat/heading-anchors/heading-anchors.js" %}</script>

        <!-- IndieAuth endpoints -->
        <link rel="authorization_endpoint" href="https://indieauth.com/auth">
        <link rel="token_endpoint" href="https://tokens.indieauth.com/token">

        <!-- Identity verification -->
        <link rel="me" href="https://github.com/jane777-pixel">
        <link rel="me" href="mailto:haileebach@gmail.com">
		<link rel="me" href="mailto:orionlw@pm.me">
		<link rel="me" href="https://github.com/orionlw">

        <!-- Webmention endpoints -->
        <link rel="webmention" href="https://webmention.io/nightdogs.xyz/webmention">
        <link rel="pingback" href="https://webmention.io/nightdogs.xyz/xmlrpc">
    </head>
    <body class="h-card" {% if layout == "layouts/post.njk" %}data-is-post="true"{% endif %}>
        <div class="site-wrapper">
        <a href="#main" id="skip-link" class="visually-hidden">Skip to main content</a>

		<header>
			<a href="/" class="home-link p-name u-url">nightdogs</a>

			{#- Read more about `eleventy-navigation` at https://www.11ty.dev/docs/plugins/navigation/ #}
			<nav>
				<h2 class="visually-hidden">Top level navigation menu</h2>
				<ul class="nav">
				{%- for entry in collections.all | eleventyNavigation %}
					<li class="nav-item"><a href="{{ entry.url }}"{% if entry.url == page.url %} aria-current="page"{% endif %}>{{ entry.title }}</a></li>
				{%- endfor %}
				</ul>
			</nav>
		</header>

		<main id="main" class="main-content">
			<heading-anchors>
				{{ content | safe }}
			</heading-anchors>
		</main>

		<footer class="p-note footer-site">
  <p>
    <em>Built with <a href="https://www.11ty.dev/">Eleventy v3.1.2</a></em>
  </p>
  <div style="display:flex;align-items:center;justify-content:flex-end;margin-top:0.5em;">
    <div class="author-theme-selector" style="display:flex;align-items:center;gap:0.25em;font-size:0.92em;opacity:0.7;">
      <span style="font-size:1em;opacity:0.5;" aria-hidden="true">ðŸŽ¨</span>
      <select id="author-select" name="author-select" style="min-width:6em;font-size:0.92em;padding:0.1em 0.7em;border-radius:0.7em;">
        <option value="jane">Jane</option>
        <option value="orionlw">Orion</option>
        <option value="adesse">AdÃ¨sse</option>
        <option value="nic">Nic</option>
        <option value="amelia">Amelia</option>
        <option value="abby">Abby</option>
        <option value="ewan">Ewan</option>
      </select>
    </div>
  </div>
  <script>
  (function() {
    const select = document.getElementById('author-select');
    const html = document.documentElement;
    const pageAuthor = html.dataset.author;
    const isPost = document.body.dataset.isPost === "true";

    if (isPost) {
      // Always use the post's author
      select.value = pageAuthor;
      html.setAttribute('data-author', pageAuthor);
      select.addEventListener('change', function() {
        html.setAttribute('data-author', this.value);
      });
    } else {
      // Use localStorage for persistence on non-post pages
      try {
        const saved = localStorage.getItem('author-theme');
        if (saved) {
          select.value = saved;
          html.setAttribute('data-author', saved);
        } else if (pageAuthor) {
          select.value = pageAuthor;
          localStorage.setItem('author-theme', pageAuthor);
        }
      } catch(e){
        if (pageAuthor) select.value = pageAuthor;
      }
      select.addEventListener('change', function() {
        html.setAttribute('data-author', this.value);
        try { localStorage.setItem('author-theme', this.value); } catch(e){}
      });
    }
  })();
  </script>
</footer>
        </div>
		<!-- This page `{{ page.url }}` was built on {% currentBuildDate %} -->
		<script type="module" src="{% getBundleFileUrl "js" %}"></script>
    </body>
</html>
